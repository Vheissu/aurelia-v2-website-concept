"use strict";(self.webpackChunkaurelia_website=self.webpackChunkaurelia_website||[]).push([[371],{371:(t,e,r)=>{r.r(e),r.d(e,{AuBlogPost:()=>j});var s={};r.r(s),r.d(s,{default:()=>a,dependencies:()=>h,name:()=>i,register:()=>u,template:()=>c});var o=r(655),n=r(134);const i="au-blog-post",c="${post}",a=c,h=[];let l;function u(t){l||(l=n.b_N.define({name:i,template:c,dependencies:h})),t.register(l)}var p=r(344);const d={maxRetries:3,interval:1e3,strategy:0};class f{constructor(t){if(this.retryConfig={...d,...void 0!==t?t:{}},2===this.retryConfig.strategy&&this.retryConfig.interval<=1e3)throw new Error("An interval less than or equal to 1 second is not allowed when using the exponential retry strategy")}request(t){return t.retryConfig||(t.retryConfig={...this.retryConfig},t.retryConfig.counter=0),t.retryConfig.requestClone=t.clone(),t}response(t,e){return Reflect.deleteProperty(e,"retryConfig"),t}responseError(t,e,r){const{retryConfig:s}=e,{requestClone:o}=s;return Promise.resolve().then((()=>{if(s.counter<s.maxRetries){const n=void 0===s.doRetry||s.doRetry(t,e);return Promise.resolve(n).then((n=>{if(n){s.counter++;const t=y(s);return new Promise((e=>setTimeout(e,isNaN(t)?0:t))).then((()=>{const t=o.clone();return"function"==typeof s.beforeRetry?s.beforeRetry(t,r):t})).then((t=>{const e={...t,retryConfig:s};return r.fetch(e)}))}throw Reflect.deleteProperty(e,"retryConfig"),t}))}throw Reflect.deleteProperty(e,"retryConfig"),t}))}}function y(t){const{interval:e,strategy:r,minRandomInterval:s,maxRandomInterval:o,counter:n}=t;if("function"==typeof r)return t.strategy(n);switch(r){case 0:return g[0](e);case 1:return g[1](n,e);case 2:return g[2](n,e);case 3:return g[3](n,e,s,o);default:throw new Error("Unrecognized retry strategy")}}const g=[t=>t,(t,e)=>e*t,(t,e)=>1===t?e:e**t/1e3,(t,e,r=0,s=6e4)=>Math.random()*(s-r)+r];class w{constructor(){this.baseUrl="",this.defaults={},this.interceptors=[],this.dispatcher=null}withBaseUrl(t){return this.baseUrl=t,this}withDefaults(t){return this.defaults=t,this}withInterceptor(t){return this.interceptors.push(t),this}useStandardConfiguration(){return Object.assign(this.defaults,{credentials:"same-origin"},this.defaults),this.rejectErrorResponses()}rejectErrorResponses(){return this.withInterceptor({response:b})}withRetry(t){const e=new f(t);return this.withInterceptor(e)}withDispatcher(t){return this.dispatcher=t,this}}function b(t){if(!t.ok)throw t;return t}const R=/^([a-z][a-z0-9+\-.]*:)?\/\//i,v=p.DI.createInterface("IHttpClient",(t=>t.singleton(m)));class m{constructor(){this.dispatcher=null,this.activeRequestCount=0,this.isRequesting=!1,this.isConfigured=!1,this.baseUrl="",this.defaults=null,this.interceptors=[]}configure(t){let e;if("object"==typeof t)e={defaults:t};else{if("function"!=typeof t)throw new Error("invalid config");{e=new w,e.baseUrl=this.baseUrl,e.defaults={...this.defaults},e.interceptors=this.interceptors,e.dispatcher=this.dispatcher;const r=t(e);Object.prototype.isPrototypeOf.call(w.prototype,r)&&(e=r)}}const r=e.defaults;if(void 0!==r&&Object.prototype.isPrototypeOf.call(Headers.prototype,r.headers))throw new Error("Default headers must be a plain object.");const s=e.interceptors;if(void 0!==s&&s.length){if(s.filter((t=>Object.prototype.isPrototypeOf.call(f.prototype,t))).length>1)throw new Error("Only one RetryInterceptor is allowed.");const t=s.findIndex((t=>Object.prototype.isPrototypeOf.call(f.prototype,t)));if(t>=0&&t!==s.length-1)throw new Error("The retry interceptor must be the last interceptor defined.")}return this.baseUrl=e.baseUrl,this.defaults=r,this.interceptors=void 0!==e.interceptors?e.interceptors:[],this.dispatcher=e.dispatcher,this.isConfigured=!0,this}fetch(t,e){this.trackRequestStart();let r=this.buildRequest(t,e);return this.processRequest(r,this.interceptors).then((t=>{let e;if(Object.prototype.isPrototypeOf.call(Response.prototype,t))e=Promise.resolve(t);else{if(!Object.prototype.isPrototypeOf.call(Request.prototype,t))throw new Error(`An invalid result was returned by the interceptor chain. Expected a Request or Response instance, but got [${t}]`);r=t,e=fetch(r)}return this.processResponse(e,this.interceptors,r)})).then((t=>Object.prototype.isPrototypeOf.call(Request.prototype,t)?this.fetch(t):t)).then((t=>(this.trackRequestEnd(),t)),(t=>{throw this.trackRequestEnd(),t}))}buildRequest(t,e){const r=null!==this.defaults?this.defaults:{};let s,o,n;const i=function(t){const e={},r=void 0!==t?t:{};for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]="function"==typeof r[t]?r[t]():r[t]);return e}(r.headers);if(Object.prototype.isPrototypeOf.call(Request.prototype,t))s=t,n=new Headers(s.headers).get("Content-Type");else{e||(e={}),o=e.body;const i=void 0!==o?{body:o}:null,c={...r,headers:{},...e,...i};n=new Headers(c.headers).get("Content-Type"),s=new Request(C(this.baseUrl,t),c)}return n||(new Headers(i).has("content-type")?s.headers.set("Content-Type",new Headers(i).get("content-type")):void 0!==o&&function(t){try{JSON.parse(t)}catch(t){return!1}return!0}(o)&&s.headers.set("Content-Type","application/json")),function(t,e){const r=void 0!==e?e:{};for(const e in r)Object.prototype.hasOwnProperty.call(r,e)&&!t.has(e)&&t.set(e,r[e])}(s.headers,i),void 0!==o&&Object.prototype.isPrototypeOf.call(Blob.prototype,o)&&o.type&&s.headers.set("Content-Type",o.type),s}get(t,e){return this.fetch(t,e)}post(t,e,r){return this.callFetch(t,e,r,"POST")}put(t,e,r){return this.callFetch(t,e,r,"PUT")}patch(t,e,r){return this.callFetch(t,e,r,"PATCH")}delete(t,e,r){return this.callFetch(t,e,r,"DELETE")}trackRequestStart(){if(this.isRequesting=!!++this.activeRequestCount,this.isRequesting&&null!==this.dispatcher){const t=new this.dispatcher.ownerDocument.defaultView.CustomEvent("aurelia-fetch-client-request-started",{bubbles:!0,cancelable:!0});setTimeout((()=>{this.dispatcher.dispatchEvent(t)}),1)}}trackRequestEnd(){if(this.isRequesting=!!--this.activeRequestCount,!this.isRequesting&&null!==this.dispatcher){const t=new this.dispatcher.ownerDocument.defaultView.CustomEvent("aurelia-fetch-client-requests-drained",{bubbles:!0,cancelable:!0});setTimeout((()=>{this.dispatcher.dispatchEvent(t)}),1)}}processRequest(t,e){return this.applyInterceptors(t,e,"request","requestError",this)}processResponse(t,e,r){return this.applyInterceptors(t,e,"response","responseError",r,this)}applyInterceptors(t,e,r,s,...o){return(void 0!==e?e:[]).reduce(((t,e)=>{const n=e[r],i=e[s];return t.then(n?t=>n.call(e,t,...o):q,i?t=>i.call(e,t,...o):O)}),Promise.resolve(t))}callFetch(t,e,r,s){return r||(r={}),r.method=s,e&&(r.body=e),this.fetch(t,r)}}function C(t,e){return R.test(e)?e:(void 0!==t?t:"")+e}function q(t){return t}function O(t){throw t}const P=p.DI.createInterface("IBlogService",(t=>t.singleton(E)));let E=class{constructor(t){this.http=t,this.http.configure((t=>t.useStandardConfiguration().withBaseUrl("https://raw.githubusercontent.com/Vheissu/aurelia-v2-website-concept/main/")))}loadPost(t){return this.http.fetch(`/blog/${t}.md`,{cache:"no-store"}).then((t=>t.text()))}loadPosts(){return this.http.fetch("blog.json",{cache:"no-store"}).then((t=>t.json()))}};E=(0,o.gn)([(0,o.fM)(0,(0,p.pZ)(v)),(0,o.w6)("design:paramtypes",[Object])],E),r(932);let j=class{constructor(t){this.blogService=t,this.postName="",this.post=""}async canLoad(t){try{return this.postName=t.postName,this.post=await this.blogService.loadPost(this.postName),!0}catch(t){return console.error(t),!1}}};j=(0,o.gn)([(0,n.MoW)(s),(0,o.fM)(0,P),(0,o.w6)("design:paramtypes",[Object])],j)}}]);